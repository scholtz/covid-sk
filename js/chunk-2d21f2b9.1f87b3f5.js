(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f2b9"],{d94b:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"app-pane-lgray py-2"},[i("b-container",{attrs:{fluid:""}},[i("b-row",[i("b-col",{attrs:{md:"7"}},[i("h1",[e._v(" Hodinové limity odberných miest "),e.placePrivider?i("span",[e._v(e._s(e.placePrivider.companyName))]):e._e()])]),0===e.tabIndex?i("b-col",{attrs:{md:"5"}},[i("b-form-select",{staticClass:"mt-2",class:""===this.place?"border-danger":"",attrs:{options:e.places,"text-field":"name","value-field":"id"},model:{value:e.place,callback:function(t){e.place=t},expression:"place"}},[i("b-form-select-option",{attrs:{disabled:"",value:""}},[e._v("Vyberte si miesto pre správu limitov")])],1)],1):e._e()],1)],1)],1),i("b-container",{staticClass:"my-4",attrs:{fluid:""}},[i("b-row",[i("b-col",[i("FullCalendar",{ref:"calendar",attrs:{id:"calendar",options:e.calendarOptions}})],1)],1)],1),e.eventinfo&&e.eventinfo.event&&e.eventinfo.event.start?i("b-modal",{attrs:{title:"Alokácia limitácie odberného miesta","ok-title":"Odobrať limit","cancel-title":"Zrušiť"},on:{ok:function(t){return e.unassignClick(e.eventinfo.event)}},model:{value:e.modalEditShow,callback:function(t){e.modalEditShow=t},expression:"modalEditShow"}},[i("div",[e._v(" Limit pre čas: "+e._s(e._f("formatDateTime")(e.eventinfo.event.start))+" - "+e._s(e._f("formatDateTime")(e.eventinfo.event.end))+" ")])]):e._e(),i("b-modal",{attrs:{title:"Alokácia limitácií odberného miesta","ok-title":"Priradiť","cancel-title":"Zrušiť"},on:{ok:e.assignClick},model:{value:e.modalSetupShow,callback:function(t){e.modalSetupShow=t},expression:"modalSetupShow"}},[""===this.place?i("div",{staticClass:"alert alert-danger"},[e._v(" Vyberte si odberové miesto ")]):i("div",[i("h4",[e._v("Odberové miesto")]),i("p",[e._v(e._s(this.placeObj.name))])]),i("h4",[e._v("Časová alokácia")]),e.fullDayMode?i("div",[e._v(" Limit na celý pracovný deň "),i("div",[e._v(" Pre dátumy Od "+e._s(e._f("formatDate")(e.fromDate))+" Do "+e._s(e._f("formatDate")(e.untilDateMinusOneDay))+" večer ")])]):i("div",[e._v(" Denne Od "+e._s(e.displayHoursFrom())+":00 Do "+e._s(e.displayHoursUntil())+":00 "),i("div",[e._v(" Pre dátumy Od "+e._s(e._f("formatDate")(e.fromDate))+" Do "+e._s(e._f("formatDate")(e.untilDate))+" ")])]),i("div",[i("label",{attrs:{for:"limit"}},[i("h4",[e._v("Hodinový limit")])]),i("b-input",{attrs:{id:"limit",type:"number",min:"0",max:"1000"},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)])],1)},a=[],r=i("a34a"),o=i.n(r),s=i("2f62"),l=i("f5ff"),c=i("3cdd"),u=i("3e32"),d=i("a20c"),p=i("327e"),h=i.n(p);function f(e,t,i,n,a,r,o){try{var s=e[r](o),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,a)}function v(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function o(e){f(r,n,a,o,s,"next",e)}function s(e){f(r,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){D(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g={components:{FullCalendar:l["a"]},data:function(){return{limit:0,modalEditShow:!1,modalSetupShow:!1,eventinfo:{},selectedUsers:{},sendingInvitation:!1,dataInvitations:[],allocations:[],fromDate:(new Date).toISOString(),untilDate:(new Date).toISOString(),roles:{DocumentManager:!1,MedicLab:!1,DataExporter:!1,Helper:!1,MedicTester:!1},revision:!1,place:"",data:[],tabIndex:-1,person:{name:"",email:"",phone:"",message:""},fields:[{label:"Meno",key:"name",sortable:!0},{label:"Email",key:"email",sortable:!0},{label:"Akcie",key:"actions",sortable:!1}],fieldsInvitations:[{label:"Meno",key:"name",sortable:!0},{label:"Email",key:"email",sortable:!0},{label:"Pozvaný osobou",key:"inviterName",sortable:!0},{label:"Čas pozvánky",key:"invitationTime",sortable:!0},{label:"Stav pozvánky",key:"status",sortable:!0},{label:"Akcie",key:"actions",sortable:!1}],calendarOptions:{locale:h.a,headerToolbar:{start:"dayGridWeek,dayGridMonth timeGridWeek,timeGridDay",center:"title",end:"today prev,next"},initialView:"timeGridWeek",plugins:[c["b"],u["a"],d["a"]],selectable:!0,eventClick:this.eventClick,select:this.select,selectAllow:this.selectAllow,contentHeight:500,slotDuration:"01:00:00",displayEventTime:!1,firstDay:1,eventDisplay:"block",events:[]},events:[],selection:{title:"Title",allDay:!0}}},computed:{placePrivider:function(){var e=this;return this.$store.state.placeProvider.places?this.$store.state.placeProvider.places.find((function(t){return t.placeProviderId===e.pp})):{}},pp:function(){return this.$store.state?this.$store.state.user.tokenData.pp:""},placeObj:function(){return this.$store.state.place.places?this.$store.state.place.places[this.place]:{}},canAssign:function(){var e=this.roles.MedicTester||this.roles.DocumentManager||this.roles.MedicLab||this.roles.DataExporter||this.roles.Helper;if(!e)return!1;for(var t in this.selectedUsers)if(this.selectedUsers[t])return!0;return!1},fullDayMode:function(){return this.displayHoursFrom()==this.displayHoursUntil()},untilDateMinusOneDay:function(){var e=new Date(this.untilDate);return e.setDate(e.getDate()-1)},places:function(){function e(e,t){return e.name<t.name?-1:e.name>t.name?1:0}return Object.values(this.$store.state.place.places).sort(e)}},watch:{pp:function(){this.ListPPInvites({placeProviderId:this.pp})},placePrivider:function(){console.log("placePrivider",this.placePrivider)},tabIndex:function(){var e=this;this.$refs.calendar&&this.$nextTick((function(){var t=e.$refs.calendar.getApi();t.next(),t.prev()}))},place:function(){var e=this;console.log("place",this.place),this.ListPlaceLimits().then((function(t){e.allocations=t,console.log("this.allocations2",e.allocations),e.redrawEvents()})),this.ListScheduledDays({placeId:this.place}).then((function(t){t&&e.processScheduledDays()}))},allPlaces:function(){var e=this;this.ListScheduledDays({placeId:this.place}).then((function(t){t&&e.processScheduledDays()}))},fromDate:function(){},untilDate:function(){}},mounted:function(){var e=this;this.ListPrivate().then((function(t){t&&e.ListPlaceLimits().then((function(t){e.allocations=t,e.redrawEvents(),console.log("this.allocations1",e.allocations)}))})),this.ReloadPlaces(),this.ListPPInvites({placeProviderId:this.pp}).then((function(t){t&&(e.dataInvitations=t)})),this.tabIndex=0},methods:b(b(b({},Object(s["b"])({ListPrivate:"placeProvider/ListPrivate",InviteUser:"user/InviteUser",ListPPInvites:"user/ListPPInvites",InviteUserToPP:"placeProvider/InviteUserToPP",LoadUsers:"user/LoadUsers",RemoveUser:"user/RemoveUser",ListScheduledDays:"place/ListScheduledDays",ReloadPlaces:"place/ReloadPrivatePlaces",SetPlaceLimitation:"place/SetPlaceLimitation",DeletePlaceLimitation:"place/DeletePlaceLimitation"})),Object(s["b"])({openSuccess:"snackbar/openSuccess",openError:"snackbar/openError"})),{},{SetLimitToPlace:function(e){var t=this;if(this.place)if(e){for(var i in console.log("limits",e,this.limit),e){var n=e[i];for(var a in n){var r=n[a];console.log("event1",n,r),this.SetPlaceLimitation({placeId:this.place,from:r.start,until:r.end,limit:this.limit})}}this.ListPlaceLimits().then((function(e){console.log("this.allocations1",t.allocations),t.allocations=e,t.ReloadPlaces().then((function(e){t.redrawEvents(),t.events=[]}))}))}else this.openError("Limity neboli zadané");else this.openError("Zadajte miesto")},ListPlaceLimits:function(){var e=this;return v(o.a.mark((function t(){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.ReloadPlaces().then((function(t){if(e.placeObj)return e.placeObj.otherLimitations}));case 1:case"end":return t.stop()}}),t)})))()},RemovePlaceLimit:function(e,t){},redrawEvents:function(){if(this.placeObj){var e=this.placeObj.otherLimitations;for(var t in this.calendarOptions.events=[],e)e[t].title=e[t].hourLimit,e[t].backgroundColor="blue",e[t].allDay=!1,e[t].start=e[t].from,e[t].end=e[t].until,this.calendarOptions.events.push(e[t])}},processScheduledDays:function(){this.events=[],this.actions={}},eventClick:function(e){this.eventinfo=e,this.modalEditShow=!0},select:function(e){this.fromDate=e.startStr,this.untilDate=e.endStr,this.modalSetupShow=!0},displayHoursFrom:function(){return new Date(this.fromDate).getHours()},displayHoursUntil:function(){return new Date(this.untilDate).getHours()},selectAllow:function(e){console.log("info",e,new Date<e.start);var t=new Date,i=t.setDate(t.getDate()-1);return!(i>e.start)},formatRoles:function(e){return e.item.roles.join(", ")},deleteUserClick:function(e){var t=this;confirm("Naozaj chcete vymazať užívateľa?")&&this.RemoveUser({email:e.item.email}).then((function(e){e&&t.LoadUsers().then((function(e){e&&(t.data=Object.values(e))}))}))},deleteInvitationClick:function(e){confirm("Naozaj chcete zrušiť pozvánku?")&&console.log("todo")},eventRender:function(e,t){console.log("eventRender",e),t.find("span.fc-event-title").html(t.find("span.fc-event-title").text())},unassignClick:function(e){var t=this;confirm("Naozaj chcete odobrať tento limit?")&&this.DeletePlaceLimitation({limitId:e.id,placeId:this.place}).then((function(e){e&&t.ReloadPlaces().then((function(e){t.ListPlaceLimits().then((function(e){t.allocations=e,t.redrawEvents()}))}))}))},assignClick:function(){var e=new Date(this.fromDate),t=new Date(this.untilDate);e.setHours(12,0,0,0),t.setHours(12,0,0,0),this.fullDayMode&&t.setDate(t.getDate()-1);for(var i=new Date(e);i<=new Date(t);i.setDate(i.getDate()+1)){var n=new Date(i);this.fullDayMode?n.setHours(0,0,0,0):n.setHours(new Date(this.fromDate).getHours(),0,0,0);var a=n.toISOString();this.fullDayMode?n.setHours(24,0,0,0):n.setHours(new Date(this.untilDate).getHours(),0,0,0);var r=n.toISOString(),o="red";this.events.push({title:this.limit,start:a,end:r,backgroundColor:o})}this.SetLimitToPlace({limits:this.events}),console.log("this.events",this.events)},roleStyle:function(e){var t=this.roleColor(e);return"background: ".concat(t,"; color: white; border-radius: 3px; margin-bottom: 5px; padding: 2px 5px; font-weight:bold; ")},getBackground:function(e){return this.roleColor(e)},roleColor:function(e){if(!e)return"black";switch(e){case"Helper":return"#666";case"MedicTester":return"green";case"MedicLab":return"blue";case"DocumentManager":return"darkorange";case"DataExporter":return"purple"}return"red"},role2Text:function(e){if(console.log("role2Text.role",e),!e)return"?";switch(e){case"Helper":return"Pomocník";case"MedicTester":return"Doktor pri odbere";case"MedicLab":return"Doktor v laboratóriu";case"DocumentManager":return"Správca certifikátov";case"DataExporter":return"Exporter údajov pre hygienu"}return"red"},name2shortcut:function(e){if(!e)return"???";var t=e.trim().split(" ");return 1==t.length?e.length<=3?e.toUpperCase():e.substring(0,3).toUpperCase():t[0].length>=1&&t[t.length-1].length>=2?(t[0].substring(0,1)+t[t.length-1].substring(0,2)).toUpperCase():(t[0].substring(0,1)+t[t.length-1].substring(0,1)).toUpperCase()+"?"},getUser:function(e){return this.placePrivider.users.find((function(t){return t.email==e}))},userNotSelected:function(){for(var e in this.selectedUsers)if(this.selectedUsers[e])return!1;return!0},roleNotSelected:function(){for(var e in this.roles)if(this.roles[e])return!1;return!0}})},y=g,P=i("2877"),w=Object(P["a"])(y,n,a,!1,null,null,null);t["default"]=w.exports}}]);